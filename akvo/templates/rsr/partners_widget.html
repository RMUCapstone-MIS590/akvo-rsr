{% load i18n rsr_filters thumbnail rsr_tags addparam %}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Akvo partners</title>
	<base target="_parent">
	{% comment %}
	<link rel="stylesheet" type="text/css" href="{{MEDIA_URL}}css/reset.css" media="screen" />
	<link rel="stylesheet" type="text/css" href="{{MEDIA_URL}}css/global.css" media="screen" />
	<link rel="stylesheet" type="text/css" href="{{MEDIA_URL}}css/style_rsr.css" media="screen" />
	{% endcomment %}
	
	<style type="text/css" media="screen">
		
		/*Reset extracted from main styles*/
		html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,
		del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,
		table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-weight:inherit;font-style:
		inherit;font-size:100%;font-family:inherit;vertical-align:baseline;} :focus{outline:0;}body{line-height:1;color
		:black;background:white;} ol,ul{list-style:none;} table{border-collapse:separate;border-spacing:0;}caption,th,td
		{text-align:left;font-weight:normal;}blockquote:before,blockquote:after,q:before,q:after{content:"";} blockquote,
		q{quotes:"" "";}

	
		/* Styles start */
		body {
			font-family: Arial, Verdana, Helvetica, Sans-serif;     
			font-size: 100%;
			line-height:1em;
			color: #333;       
			background-color: #fff;
			}
			
		a:link, a:visited, a:active {
			text-decoration: none;
			color:#1D7FC8;
			}
							
		.grey {
			color: #999;
			}

		.small {
			font-size:0.8333em;
			}
			
		.selected {
			font-weight:bold;
			}
		
		#wrap {
			width:710px;
			max-width:710px;
			margin:0;
			padding:0;
			}
		
		#heightcontrain {
			height:770px;
			max-height:770px;
			overflow: auto;
			height: expression( this.scrollHeight > 4 ? "770px" : "auto" ); /* sets max-height for IE */
			border-bottom:1px solid #999;
			background: #fff url({{MEDIA_URL}}img/partners_widget/table_header_bkgd.png) repeat-y left;
			padding-left:1px;
			width:709px;
			}
		
		div.padder {
			margin:10px;
			/*background-color:#efefef;*/
			overflow:hidden;
			}
		div.selectedColumnHeaderDesc {
			background: url({{MEDIA_URL}}img/partners_widget/header_down_arrow.png) no-repeat right bottom;
		}
		
		div.selectedColumnHeaderAsc {
			background: url({{MEDIA_URL}}img/partners_widget/header_up_arrow.png) no-repeat right bottom;
		}
		
		table {
			margin: 0px;
			border-collapse:collapse;
			width:100;
			font-size:0.75em;
			}
		
		th {
			background: #ccc url({{MEDIA_URL}}img/partners_widget/table_header_bkgd.png) repeat-y right;
			height:40px;
			padding: 0px;
			text-align: center;
			vertical-align: top;	
			}	

		td {
			background: #fff url({{MEDIA_URL}}img/partners_widget/table_cell_bkgd.png) repeat-y right;
			border-bottom:1px solid #ccc;
			vertical-align: top;
			padding:0;
			}
			
		th#orgColumnHeader {
			width:230px !important; 
			max-width:230px !important;
			min-width:230px !important;
			}
		td.orgColumnCell {
			width:229px !important; 
			max-width:229px !important;
			min-width:229px !important;
			}
			
		th#typeColumnHeader { 
			width:100px !important; 
			max-width:100px !important;
			min-width:100px !important;
			}
		td.typeColumnCell {
			width:100px !important; 
			max-width:100px !important;
			min-width:100px !important;
			}
			
		th#locationColumnHeader { 
			width:115px !important; 
			max-width:115px !important;
			min-width:115px !important;
			}
		td.locationColumnCell {
			width:115px !important; 
			max-width:115px !important;
			min-width:115px !important;
			}

		th#totalColumnHeader { 
			width:70px !important; 
			max-width:70px !important;
			min-width:70px !important;
			}
		td.totalColumnCell {
			width:70px !important; 
			max-width:70px !important;
			min-width:70px !important;
			}
		
		th#reqColumnHeader { 
			width:90px !important; 
			max-width:90px !important;
			min-width:90px !important;
			}
		td.reqColumnCell {
			width:90px !important; 
			max-width:90px !important;
			min-width:90px !important;
			}
		
		th#neededColumnHeader { 
			background-image: none !important;
			}
		td.neededColumnCell {
			background-image: none !important;
			}
		th.active {
			background-color:#DBDBDB;
		}
	</style>
		
</head>
<body>	
<div id="wrap">
	<table class="project_table" style="width:710px; max-width:710px;">
		<thead>
			<tr>
			<th id="orgColumnHeader" class="{% ifequal order_by 'name' %}active{% endifequal %}">
				<div class="padder {% ifequal mode 'name_desc' %}selectedColumnHeaderDesc{% endifequal %}{% ifequal mode 'name_asc'  %}selectedColumnHeaderAsc{% endifequal %}">
					<a href="{% url akvo.rsr.views.partners_widget%}{% addparam "order_by" "name" "prev" order_by "sort" sort %}" 
					{% ifequal order_by 'name'  %} class="selected"	{% endifequal %} target="_self">
					{% trans 'Project Partners' %}
					</a>
					<span style="color:#888;">({{orgs.count}})</span>
				</div>
				
				{% comment %}
				
				{% ifequal order_by 'name' %}
				<div class="padder {% ifequal sort 'desc' %}selectedColumnHeaderDesc{% else %}selectedColumnHeaderAsc{% endifequal %}">
					<a href="{% url akvo.rsr.views.partners_widget%}{% addparam "order_by" "name" "prev" order_by "sort" sort %}" 
					{% ifequal order_by 'name'  %} class="selected"	{% endifequal %} target="_self">
					{% trans 'Project Partners' %}
					</a>
					<span style="color:#888;">({{orgs.count}})</span>
				</div>
				{% else %}	
				<div class="padder">
					<a href="{% url akvo.rsr.views.partners_widget%}{% addparam "order_by" "name" "prev" order_by "sort" sort %}" 
					{% ifequal order_by 'name'  %} class="selected"	{% endifequal %} target="_self">
					{% trans 'Project Partners' %}
					</a>
					<span style="color:#888;">({{orgs.count}})</span>
				</div>
				{% endifequal %}
				{% endcomment %}
			</th>
			<th id="typeColumnHeader" class="{% ifequal order_by 'organisation_type' %}active{% endifequal %}">
				<div class="padder {% ifequal mode 'organisation_type_desc' %}selectedColumnHeaderDesc{% endifequal %}{% ifequal mode 'organisation_type_asc' %}selectedColumnHeaderAsc{% endifequal %}">
					<a href="{% url akvo.rsr.views.partners_widget%}{% addparam "order_by" "organisation_type" "prev" order_by "sort" sort%}"
					{% ifequal order_by 'organisation_type'  %} class="selected" {% endifequal %} target="_self">
						{% trans 'Type' %}
					</a>
				</div>
				
				{% comment %}

				{% ifequal order_by 'organisation_type' %}
				<div class="padder {% ifequal sort 'desc' %}selectedColumnHeaderDesc{% else %}selectedColumnHeaderAsc{% endifequal %}">
					<a href="{% url akvo.rsr.views.partners_widget%}{% addparam "order_by" "organisation_type" "prev" order_by "sort" sort%}"
					{% ifequal order_by 'organisation_type'  %} class="selected" {% endifequal %} target="_self">
						{% trans 'Type' %}
					</a>
				</div>
				{% else %}
				<div class="padder">
					<a href="{% url akvo.rsr.views.partners_widget%}{% addparam "order_by" "organisation_type" "prev" order_by "sort" sort%}"
					{% ifequal order_by 'organisation_type'  %} class="selected" {% endifequal %} target="_self">
						{% trans 'Type' %}
					</a>
				</div>
				
				{% endifequal %}
				{% endcomment %}
			</th>
			<th id="locationColumnHeader" class="{% ifequal order_by 'country' %}active{% endifequal %}{% ifequal order_by 'country__continent' %}active{% endifequal %}">
				<div class="padder {% ifequal mode 'location_desc' %}selectedColumnHeaderDesc{% endifequal %}{% ifequal mode   'location_asc' %}selectedColumnHeaderAsc{% endifequal %}">
					<a href="{% url akvo.rsr.views.partners_widget%}{% addparam "order_by" "country" "prev" order_by "sort" sort%}"
					{% ifequal order_by 'country' %} class="selected" {% endifequal %} target="_self">
					{% trans 'Country' %}</a> /<br>
					<a href="{% url akvo.rsr.views.partners_widget%}{% addparam "order_by" "country__continent" "prev" order_by "sort" sort%}"
					{% ifequal order_by 'country__continent' %} class="selected" {% endifequal %} target="_self">
					{% trans 'Continent' %}
					</a>
				</div>
			</th>
			<th id="totalColumnHeader">
				<div class="padder">
					{% trans 'Total projects' %}
				</div>
			</th>
			<th id="reqColumnHeader">
				<div class="padder">
					{% trans 'Funds requested' %}
				</div>
			</th>
			<th id="neededColumnHeader">
				<div class="padder">
					{% trans 'Funds still needed' %}
				</div>
			</th>
			</tr>
		</thead>
	</table>
	<div id="heightcontrain">
		<table class="project_table">
			<tbody>
			{% for o in orgs %}
			<tr>
				<td class="orgColumnCell">
					<div class="padder">
						{% if o.logo %}
				            <a href="{% url akvo.rsr.views.orgdetail o.id %}">
							<img src="{% thumbnail o.logo 100x75 %}" alt="{{o.name}}" style="float:left; margin-right: 10px;" />
				            </a>
						{% else %}
							<div style="background-color: #ccc; width: 100px; height: 75px; float:left; margin-right: 10px"></div>
						{% endif %}
						<a href="{% url akvo.rsr.views.orgdetail o.id %}">{{o.name}}</a>
						<div class="grey small">{{o.long_name}}</div>
						<div style="clear: left;">
						{% category_icons_org o %}
					 	</div>
					</div>
				</td>
				<td class="typeColumnCell">
					<div class="padder">
						{{o.get_organisation_type_display}}
					</div>
				</td>
				<td class="locationColumnCell">
					<div class="padder">
						{{o.country}},<br>{{o.country.get_continent_display}}
					</div>
				</td>
				<td class="totalColumnCell">
					<div class="padder">
						<a href="{% url akvo.rsr.views.filteredprojectlist o.id %}#list">{{o.published_projects.count}}</a>
					</div>
				</td>
				<td class="reqColumnCell">
					<div class="padder">
						{% ifequal o.funding.still_needed 0 %}
							<span style="color: green">
						{% else %}
							<span>
						{% endifequal %}
						<b>&#8364; {{o.funding.total|round}}</b>
						</span>
					</div>
				</td>
				<td class="neededColumnCell">
					<div class="padder">
						{% ifequal o.funding.still_needed 0 %}
							<span>
						{% else %}
							<span style="color: red">
						{% endifequal %}
						<b>&#8364; {{o.funding.still_needed|round}}</b>
						</span>
					</div>
				</td>
			</tr>
			{% endfor %}
			</tbody>
		</table>
	</div>
</div>
</body>
</html>
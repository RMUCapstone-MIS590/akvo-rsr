{% load google_maps i18n l10n templatetag_handlebars %}

<div class="akvo_map" id="{{map_id}}" style="width:{{width}}px;height:{{height}}px;"></div>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script type="text/javascript">
  {{map_id}} = {
    "type": "{{type}}",
    "objectId": {{object.id}},
    "Lat": {{object.primary_location.latitude|unlocalize}},
    "Lng": {{object.primary_location.longitude|unlocalize}},
    "zoom": {{zoom}}
  }
</script>


{% comment %}
{% tplhandlebars "{{map_id}}_tmpl" %}
<div class="mapInfoWindow" style="height:150px; min-height:150px; max-height:150px; overflow:hidden;">
  <a href="{{projectPath}}">{{projectTitle}}</a>
  {{#if projectImage}}
    <div style="text-align: center; margin-top: 10px;">
      <a href="{{projectPath}}" title="{{projectTitle}}">
        <img src="{{projectImage}}" alt="">
      </a>
    </div>
  {{/if}}
</div>
{% endtplhandlebars %}
{% endcomment %}


{% comment %}
<script type="text/javascript"> 

//   var akvoMap = {
//     getLocations: function() {
//       var resouceUrl= "http://akvo.dev/api/v1/project_location/?format=jsonp&project=436";

//       $.getJSON(resouceUrl + "?callback=", function(data) {
//         $.each(data.objects, function(i, location) {
//           console.log(location.city);
//         });
//       });
//     }
//   };
  
//   window.onload = function() {
//     akvoMap.getLocations()
//   };
// </script>
{% endcomment %}



{% comment %}
{# <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script> #}
{# <script src="http://akvo.dev/rsr/media/core/js/jquery.ui.map.full.min.js" type="text/javascript"></script> #}
<script type="text/javascript">
  jQuery = window.jQuery.noConflict(true);
  jQuery(document).ready(function($) {
    var map = jQuery('#map_canvas');

    map.gmap(mapOptions).bind('init', function() {
      $.getJSON('http://akvo.dev/api/v1/project_location/?format=jsonp&project=436?callback=?', function(data) {
        $.each(data.projects, function(i, location) {
          console.log(location.city);
        });
      });
    });
  });

  var mapOptions = {}
  // http://www.akvo.org/api/v1/project_location/?format=jsonp&project=436
  document.write("In the map");
</script>
{% endcomment %}
{% extends "rsr/project/project_subpage_base.html" %}
{% load webdesign addparam cache humanize i18n rsr_filters rsr_tags thumbnail counter_tags oembed_tags %}
{% load url from future %}


{% block breadcrum_items %}
{{block.super}}
<li id="last_breadcrum_item">{% trans 'Project updates' %}</li>
{% endblock breadcrum_items %}

{% block project_left_column %}
	<div class="white_box" style="background-color:#fff;">
		<div style="float:left; margin-left:20px; margin-top:10px">
			<span class="small">
				<a href="{% url 'project_main' project.id %}">&#x25C0; {% trans 'Back to main project page' %}</a>
			</span>
			<h2 style="padding-top:20px;">{% trans 'Project updates' %}</h2>
		</div>
		{% comment %}
		<div class="counter_badge">
			<span style="display:none;">{% counter project %}</span>
			{% cache 10 project.view_count %}
				{{ project.view_count|intcomma }}
			{% endcache %}
			<br />
			<span>{% trans 'views' %}</span>
		</div>
		{% endcomment %}
		<div class="clear"></div>
		<div class="space20">
			{% if not updates %}
				<p>{% trans 'No updates yet.' %}</p>
			{% else %}
				{% for update in updates %}
					<div class="grey_hover" style="padding:10px; {% if not forloop.last %}border-bottom:1px solid #ccc;{% endif %}">
						<div style="float:left; width:100px;">
							<span class="grey small" style="padding-right:5px;">{{update.time|date:"d-M-Y"}}</span>
						</div>
											
						<div style="float:left; width:240px; margin: 0 10px;">
                        {% if update.video_thumbnail %}
								<div style="width:240px; margin-left:auto; margin-right:auto;">
                                <a href="{% url 'project_update' project.id update.id %}">
									<img src="{{ update.video_thumbnail }}" alt="{{ update.video_title }}" width=240px>
                                </a>
								</div>
							{% else %}
								{% if update.photo %}
									<a href="{% url 'project_update' project.id update.id %}">
										<img src="{% thumbnail update.photo 116x100 crop autocrop upscale sharpen %}" />
									</a>
								{% else %}
									&nbsp;
								{% endif %}
							{% endif %}
						</div>
						
						{% if update.title or update.text %}
						<div style="float:left; width:240px;">
							<p style="margin:0;">
								{% if update.title %}
									<a href="{% url 'project_update' project.id update.id %}">{{update.title|capfirst}}</a><br />	
								{% endif %}
								{% if update.text %}
									<span class="grey small">{{update.text|smart_truncate:150}}</span>
								{% endif %}
							</p>
						</div>
						{% else %}
						<p class="small grey">
							<span class="grey small">
								{% if update.photo_caption %}
									{{update.photo_caption}}<br />									
								{% endif %}
							</span>
						{% endif %}
						<div class="clear"></div>
					</div>
				{% endfor %}
			{% endif %}
		</div>
	</div>
{% endblock project_left_column%}

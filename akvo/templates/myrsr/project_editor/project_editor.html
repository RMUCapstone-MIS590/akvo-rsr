{% extends "myrsr/myrsr_base.html" %}
{% load i18n bootstrap3 rsr_utils compressed rules humanize project_editor %}
{% block title %}{% trans 'MyRSR - Project Editor' %}{% endblock %}
{% block myrsr_main %}
    <!--[if lte IE 9]>
    <div class="alert alert-danger" role="alert">
      <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
      {% trans 'You are using an unsupported browser (Internet Explorer 9 or less). Please update your browser to a newer version or use a different browser.' %}
    </div>
    <![endif]-->

    <!--*************************************** Project editor header **********************************************-->
    <div class="row">
        <div class="col-md-8">
            <h3>{% trans 'Project Editor' %} <span class="glyphicon glyphicon-info-sign info-icon activated" onclick="toggleId(event, this, 'editorHelptext');"></span></h3>
        </div>
        <div class="col-md-4">
            <div class="editDate">
                <span>{% trans 'Date created' %}:</span>
                <time datetime="YYYY-MM-DDThh:mm:ssTZD">{{ project.created_at }}</time><br/>
                <span>{% trans 'Last modified' %}:</span>
                <time datetime="YYYY-MM-DDThh:mm:ssTZD">{{ project.last_modified_at }}</time>
            </div>
        </div>
    </div>
    <div class="help-block" id="editorHelptext">
        {% trans 'Your RSR project page shows project information about what’s happening, where and who’s involved, as well as who the funders are. Tell your project’s story by entering complete information. After a project is published you can keep it up to date by adding project updates with text, photos and videos.' %}<br/><br/>
        {% trans 'Before you start, please review all the project fields so you know which information belongs where in the RSR project form.' %}<br/><br/>
        {% trans 'RSR editors can edit the project information, and RSR administrators can edit and publish the project once all mandatory fields are filled out and the progress bar on top of the page is green. Changes that are made to a published project, will be visible online immediately after saving.' %}<br/><br/>
        {% trans 'If you have questions, please get in touch with us via' %} <a href="mailto:support@akvo.org">support@akvo.org</a>.
    </div>

    <!--*************************************** Project editor progress **********************************************-->
    <div class="panel panel-success formProgress">
        <div class="panel-heading">
            <h3 class="panel-title">
                {% trans 'Project progress' %}
            </h3>
        </div>
        <div class="panel-body">
            <div class="row help-block">
                <div class="col-md-12"><strong>{% trans 'Legenda' %}</strong></div>
                <div class="row">
                    <div class="col-xs-1"></div>
                    <div class="col-xs-1"><span class="redLegenda">{% trans 'legend' %}</span></div>
                    <div class="col-xs-8 col-xs-offset-1">{% trans 'No mandatory fields completed' %}</div>
                </div>
                <div class="row">
                    <div class="col-xs-1"></div>
                    <div class="col-xs-1"><span class="orangeLegenda">{% trans 'legend' %}</span><br/></div>
                    <div class="col-xs-8 col-xs-offset-1">{% trans 'Some mandatory fields completed' %}</div>
                </div>
                <div class="row">
                    <div class="col-xs-1"></div>
                    <div class="col-xs-1"><span class="greenLegenda">{% trans 'legend' %}</span></div>
                    <div class="col-xs-8 col-xs-offset-1">{% trans 'All mandatory fields completed' %}</div>
                </div>
            </div>
            <hr/>
            <div class="rsr-progress">
                <div class="row help-block">
                    <div class="col-md-12"><strong>{% trans 'Akvo RSR' %}</strong></div>
                    <div class="col-md-12">{% trans 'This progress bar indicates the number of completed mandatory fields for Akvo RSR. It is only possible to publish a project when this progress bar is green and fully filled, meaning that all mandatory fields have been completed. Mandatory fields for Akvo RSR are marked with a' %} <span class="mandatoryIndicator">*</span>.</div>
                </div>
                <div class="progress overview">
                    <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100">
                        <span class="sr-only"></span><span class="progress-percentage"></span>
                    </div>
                </div>
            </div>
            <div class="iati-progress {% if not advanced_editor %}hidden hide-default{% endif %}">
                <hr/>
                <div class="row help-block">
                    <div class="col-md-12"><strong>{% trans 'International Aid Transparency Initiative' %}</strong></div>
                    <div class="col-md-12">{% trans 'This progress bar indicates the number of completed mandatory fields for IATI. When this bar is green, it is possible to export a valid IATI XML file of this project from Akvo RSR.' %}</div>
                </div>
                <div class="progress overview">
                    <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100">
                        <span class="sr-only"></span><span class="progress-percentage"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--*************************************** Project editor options **********************************************-->
    <div class="panel panel-info formOverviewInfo">
        <div class="panel-heading">
            <h3 class="panel-title">
                {% trans 'Project editor options' %}
            </h3>
        </div>
        <div class="panel-body">
            {% has_perm 'rsr.change_publishingstatus' user project.publishingstatus as can_publish %}
            {% if can_publish %}
                <div class="row">
                    <div class="col-md-3">
                        <button class="btn {% if project.is_published %}btn-danger{% else %}btn-success{% endif %}" id="publishProject" status="{% if not project.is_published %}un{% endif %}published">
                            {% if project.is_published %}
                                <span class="glyphicon glyphicon-remove"></span> {% trans 'Unpublish project' %}
                            {% else %}
                                <span class="glyphicon glyphicon-ok"></span> {% trans 'Publish project' %}
                            {% endif %}
                        </button>
                    </div>
                    <div class="col-md-9 help-block">
                        {% trans 'This project is:' %}
                        {% if project.is_published %}
                            <span class="published" id="publishingStatus">{% trans 'published' %}</span>.
                        {% else %}
                            <span class="notPublished" id="publishingStatus">{% trans 'not published' %}</span>.
                        {% endif %}
                        {% trans 'It is only possible to publish this project when the above progress bar is green and fully filled. This means that all mandatory fields for this project have been completed.' %}
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3"></div>
                    <div class="col-md-9 help-block" id="publishErrors"></div>
                </div>
                <hr/>
            {% endif %}
            <div class="show-default {% if advanced_editor %}hidden{% endif %}">
                <div class="row show-default">
                    <div class="col-md-3">
                        <button class="btn btn-primary" id="showAdvancedFields"><span class="glyphicon glyphicon-resize-full"></span> {% trans 'Advanced editor' %}</button>
                    </div>
                    <div class="col-md-9 help-block">
                        {% trans 'Enabling this option will allow you to see and use all available fields in RSR, specifically the fields which are available in IATI but used for specific purposes. In addition, another progress bar for the IATI fields will be added to the project progress section on top.' %}
                    </div>
                </div>
                <hr/>
            </div>
            <div class="row">
                <div class="col-md-3">
                    <a href="{% url 'project-main' project.pk %}" target="_blank">
                        <button class="btn btn-primary viewProject" id="viewProject"><span class="glyphicon glyphicon-expand"></span> {% if not project.is_published %}{% trans 'Preview project page' %}{% else %}{% trans 'View project page' %}{% endif %}</button>
                    </a>
                </div>
                <div class="col-md-9 help-block">
                    {% trans 'View the project page in a new tab. In case the project is not published yet, a preview of the project page will be shown, which is only visible to admins and project editors of this project.' %}
                </div>
            </div>
        </div>
    </div>

    <!--*************************************** Project editor sections **********************************************-->
    <section class="panels projectEdit">
        {% with text_input="myrsr/project_editor/fields/text_input.html" textarea_input="myrsr/project_editor/fields/textarea_input.html" choice_input="myrsr/project_editor/fields/choice_input.html" date_input="myrsr/project_editor/fields/date_input.html" typeahead_input="myrsr/project_editor/fields/typeahead_input.html" file_input="myrsr/project_editor/fields/file_input.html" currency_input="myrsr/project_editor/fields/currency_input.html" custom_field_input="myrsr/project_editor/fields/custom_field_input.html" %}
        <fieldset>
            {% include "myrsr/project_editor/section_1/section_1.html" %}
            {% include "myrsr/project_editor/section_2/section_2.html" %}
            {% include "myrsr/project_editor/section_3/section_3.html" %}
            {% include "myrsr/project_editor/section_4/section_4.html" %}


                <!--*************************************** Section 5 **********************************************-->
                <div class="myPanel borderBottom" id="panel5">
                    <div class="formStep stepFive">
                        <div class="toggleSection">
                            <label for="stepFive" class="stepLabel"><h4>05 - {% trans 'Results and indicators' %}<span class="glyphicon glyphicon-info-sign info-icon hidden" onclick="toggleId(event, this, 'step-5-helptext');"></span></h4></label>
                        </div>
                        <input type="radio" name="step" id="stepFive">
                        <div class="progress section-progress">
                            <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100">
                                <span class="sr-only"></span><span class="progress-percentage"></span>
                            </div>
                        </div>
                        <div class="formBlock hidden">
                            <div class="hidden" id="step-5-helptext">
                                <p class="help-block">{% trans 'In the results and indicators section you can define which results you plan to achieve and how you will measure these to be able to monitor and evaluate your project. There are three main types of results. Outputs are usually very practical. For example to organise a particular type of training. An indicator can be the number of trainings given. This is easy to measure. Outcome results occur when users use outputs, for example when people portray different behaviour because of the training they took part in. Impact is a broader result such as empowered citizens.' %}</p>
                                <p class="help-block">{% trans 'Indicators help us to measure progress on these various types of results. They are usually easy to determine for outputs (e.g. 9 trainings), harder for outcomes (e.g. number of policy documents written) and hardest (or near to impossible) for impacts. You can set a target value (e.g. 9 trainings) and later add the actual value (e.g. 8 trainings took place). This gives you progress information against set targets for monitoring and evaluation purposes. Sometimes baseline values are used to measure against (e.g. average income level at project start).' %}</p>
                                <p class="help-block">{% trans 'Lastly, indicators can be separated per period. Especially for longer projects this is helpful to track progress during the project. For example, you can set a target of 3 trainings per year for a 3 year project. When you don’t add a period for an indicator, it is assumed that the indicator (and the target and actual values) applies to the full project period. A full example:' %}</p>
                                <p class="help-block"><i>{% trans 'Result: "Organise training sessions for staff"' %}<br/>
                                <span class="tab"></span>{% trans 'Indicator: "Organise 10 training sessions"' %}<br/>
                                <span class="tab"></span><span class="tab"></span>{% trans 'Indicator period: "01-01-2015 - 31-12-2015 (Target: 10 / Actual: 5)"' %}</i></p>
                            </div>
                            <form role="form" id="admin-step-5">
                            <h5>{% trans 'Results' %}</h5>
                            <div class="row {% if not user.is_superuser %}hidden{% endif %}">
                                <div class="col-xs-6 col-sm-8">
                                    <div class="form-group control">
                                        <div class="checkbox">
                                            <label for="impactProject" class="control-label">
                                                <input id="impactProject" type="checkbox" name="impactProject" class="priority2" {% if project.is_impact_project %}checked saved-value="True"{% else %}saved-value="False"{% endif %}>
                                                    {% trans 'RSR Impact project' %}
                                            </label>
                                        </div>
                                        <p class="help-block hidden">
                                            {% trans 'Indicate whether the project is an RSR Impact project. When this option is set, the project page will display the results framework, and it will be possible to update the actual values of indicators through updates.' %}
                                        </p>
                                    </div>
                                </div>
                                {% if project.parents.count == 1 and project.is_impact_project %}
                                    <div class="col-xs-6 col-sm-4" style="text-align: right;">
                                        <button class="btn btn-primary" id="import-results"><i class="glyphicon glyphicon-import"></i> {% trans 'Import results' %}</button>
                                    </div>
                                {% endif %}
                            </div>
                            <div class="result-container" id="result-container">
                                {% for result in project.results.all %}
                                    {% include "myrsr/project_editor/result_input.html" with key=result.pk %}
                                {% empty %}
                                    {% include "myrsr/project_editor/result_input.html" with key='add-0' %}
                                {% endfor %}
                            </div>
                            <div class="row form-group">
                                <div class="col-md-12 text-center add-object-link">
                                    <a href="#" class="add-result" id=""><span class="glyphicon glyphicon-plus"></span> {% trans 'Add another result' %}</a>
                                </div>
                            </div>
                            <h5 class="hidden hide-default">{% trans 'Project conditions' %}</h5>
                            <div class="condition-container hidden hide-default" id="condition-container">
                                {% for condition in project.conditions.all %}
                                    {% include "myrsr/project_editor/condition_input.html" with key=condition.pk %}
                                {% empty %}
                                    {% include "myrsr/project_editor/condition_input.html" with key='add-0' %}
                                {% endfor %}
                            </div>
                            <div class="row form-group hidden hide-default">
                                <div class="col-md-12 text-center add-object-link">
                                    <a href="#" class="add-condition" id=""><span class="glyphicon glyphicon-plus"></span> {% trans 'Add another condition' %}</a>
                                </div>
                            </div>
                            {% for customfield in custom_fields_section_5 %}
                                <div id="custom_field-{{ customfield.pk }}">
                                    {% if customfield.type == 'text' %}
                                    <div class="form-group control">
                                        <textarea id="custom-field-{{ customfield.pk }}" class="form-control priority{% if customfield.mandatory %}1{% else %}2{% endif %}" name="custom-field-{{ customfield.pk }}" {% if customfield.max_characters > 0 %}maxlength="{{ customfield.max_characters }}"{% endif %} saved-value="{{ customfield.value }}">{{ customfield.value }}</textarea>
                                        <label class="control-label" for="custom-field-{{ customfield.pk }}">{{ customfield.name }}</label>
                                        {% if customfield.help_text %}<p class="help-block hidden">{{ customfield.help_text|safe }}</p>{% endif %}
                                    </div>
                                    {% elif customfield.type == 'boolean' %}
                                        <div class="form-group control">
                                            <div class="checkbox">
                                                <label for="custom-field-{{ customfield.pk }}" class="control-label">
                                                    <input id="custom-field-{{ customfield.pk }}" type="checkbox" name="custom-field-{{ customfield.pk }}" class="priority2 boolean-custom-field" {% if customfield.value == 'True' %}checked saved-value="True"{% else %}saved-value="False"{% endif %}>
                                                        {{ customfield.name }}
                                                </label>
                                            </div>
                                            {% if customfield.help_text %}
                                                <p class="help-block hidden">{{ customfield.help_text|safe }}</p>
                                            {% endif %}
                                        </div>
                                    {% endif %}
                                </div>
                            {% endfor %}
                            <div class="row form-group">
                                <div class="col-xs-8 col-sm-10" style="text-align: center;" id="savingstep5"></div>
                                <div class="col-xs-4 col-sm-2" style="text-align: right;">
                                    <button type="submit" class="btn btn-success" id="savingstep5-button"><i class="glyphicon glyphicon-save"></i> {% trans 'Save' %}</button>
                                </div>
                            </div>
                            </form>
                        </div>
                    </div>
                </div>
                <!--*************************************** Section 6 **********************************************-->
                <div class="myPanel borderBottom" id="panel6">
                    <div class="formStep stepSix">
                        <div class="toggleSection">
                            <label for="stepSix" class="stepLabel"><h4>06 - {% trans 'Finance' %}<span class="glyphicon glyphicon-info-sign info-icon hidden" onclick="toggleId(event, this, 'step-6-helptext');"></span></h4></label>
                        </div>
                        <input type="radio" name="step" id="stepSix">
                        <div class="progress section-progress">
                            <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100">
                                <span class="sr-only"></span><span class="progress-percentage"></span>
                            </div>
                        </div>
                        <div class="formBlock hidden">
                            <div class="hidden" id="step-6-helptext">
                                <p class="help-block">{% trans 'You can define the budget information as a total for the whole project or within sections and periods to provide more granular information about where the project funds are being spent.' %}</p>
                                <p class="help-block">{% trans 'Transactions refer to the actual transfers of funds between organisations related to the funding and expenditure of the project. This information is crucially important when defining the funding chain within the development aid sector and can help to shape the overall picture. Providing this information can also be beneficial to give clarity on expenditure over periods of time which is reflected within the results obtained for the project.' %}</p>
                            </div>
                            <form role="form" id="admin-step-6">
                            <div class="form-group">
                                <div class="checkbox">
                                    <label for="donateButton" class="control-label">
                                        <input id="donateButton" type="checkbox" name="donateButton" class="priority2" {% if project.donate_button %}checked saved-value="True"{% else %}saved-value="False"{% endif %}>{% trans 'Donate button' %}
                                    </label>
                                </div>
                                <p class="help-block hidden">
                                    {% trans 'If you tick the checkbox, a donate button will appear on your project page, enabling donations to your project from people visiting the page. The donate button will only appear if your project needs funding,' %}
                                </p>
                            </div>
                            <h5>{% trans 'Budget items' %}</h5>
                            <p class="help-block">{% trans 'The total value of all budget items is:' %} <span class="currency-display">{{ project.get_currency_display }}</span> <span id="total-budget">{% if project.budget %}{{ project.budget|floatformat:0|intcomma }}{% else %}0{% endif %}</span></p>
                            <div class="form-group control hidden hide-default">
                                <div class="input-group priority3">
                                    <input type="text" class="form-control" name="capital-spend-percentage" id="capital-spend-percentage"
                                    value="{% if project.capital_spend_percentage %}{{project.capital_spend_percentage}}{% endif %}" saved-value="{% if project.capital_spend_percentage %}{{project.capital_spend_percentage}}{% endif %}">
                                    <span class="input-group-addon">%</span>
                                </div>
                                <label for="capital-spend-percentage" class="control-label">{% trans 'Capital spend percentage' %}</label>
                                <p class="help-block hidden">{% trans 'The percentage of the total commitment allocated to or planned for capital expenditure. Content must be a positive decimal number between 0 and 100, with no percentage sign. Use a period to denote decimals.' %}</p>
                            </div>
                            <div class="budget-item-container" id="budget-item-container">
                                {% for item in project.budget_items.all %}
                                    {% include "myrsr/project_editor/budget_item_input.html" with key=item.pk %}
                                {% empty %}
                                    {% include "myrsr/project_editor/budget_item_input.html" with key='add-0' %}
                                {% endfor %}
                            </div>
                            <div class="row form-group">
                                <div class="col-md-12 text-center add-object-link">
                                    <a href="#" class="add-budget-item" id=""><span class="glyphicon glyphicon-plus"></span> {% trans 'Add another budget item' %}</a>
                                </div>
                            </div>
                            <div class="hide-default {% if not advanced_editor %}hidden{% endif %}">
                                <h5>{% trans 'Country budget items' %}</h5>
                                <div class="form-group">
                                    <div class="select-group control">
                                        <select name="country-budget-vocabulary" id="country-budget-vocabulary" class="form-control priority3" saved-value="{{ project.country_budget_vocabulary }}">
                                            <option value="" {% if not project.country_budget_vocabulary %}selected="selected"{% endif %}></option>
                                            {% for vocabulary in budget_identifier_vocabularies %}
                                                <option value="{{ vocabulary.code }}" {% if project.country_budget_vocabulary == vocabulary.code %} selected="selected" {% endif %}>{{ vocabulary.code }} - {{ vocabulary.name }}</option>
                                            {% endfor %}
                                        </select>
                                        <label for="country-budget-vocabulary" class="control-label">{% trans 'Country budget vocabulary' %}</label>
                                        <p class="help-block hidden">{% trans 'Enter an IATI code for the common functional classification or country system (this allows for common codes, country-specific codes, or any other classification agreed between countries and donors) see:' %} <a href="http://iatistandard.org/201/codelists/BudgetIdentifierVocabulary/" target="_blank">http://iatistandard.org/201/codelists/BudgetIdentifierVocabulary/</a>.</p>
                                    </div>
                                </div>
                                <div class="country-budget-item-container" id="country-budget-item-container">
                                    {% for item in project.country_budget_items.all %}
                                        {% include "myrsr/project_editor/country_budget_item_input.html" with key=item.pk %}
                                    {% empty %}
                                        {% include "myrsr/project_editor/country_budget_item_input.html" with key='add-0' %}
                                    {% endfor %}
                                </div>
                                <div class="row form-group">
                                    <div class="col-md-12 text-center add-object-link">
                                         <a href="#" class="add-country-budget-item" id=""><span class="glyphicon glyphicon-plus"></span> {% trans 'Add another country budget item' %}</a>
                                    </div>
                                </div>
                                <h5>{% trans 'Transactions' %}</h5>
                                <div class="transaction-container" id="transaction-container">
                                    {% for transaction in project.transactions.all %}
                                        {% include "myrsr/project_editor/transaction_input.html" with key=transaction.pk %}
                                    {% empty %}
                                        {% include "myrsr/project_editor/transaction_input.html" with key='add-0' %}
                                    {% endfor %}
                                </div>
                                <div class="row form-group">
                                    <div class="col-md-12 text-center add-object-link">
                                        <a href="#" class="add-transaction" id=""><span class="glyphicon glyphicon-plus"></span> {% trans 'Add another transaction' %}</a>
                                    </div>
                                </div>
                                <h5>{% trans 'Planned disbursements' %}</h5>
                                <div class="planned-disbursement-container" id="planned-disbursement-container">
                                    {% for pd in project.planned_disbursements.all %}
                                        {% include "myrsr/project_editor/planned_disbursement_input.html" with key=pd.pk %}
                                    {% empty %}
                                        {% include "myrsr/project_editor/planned_disbursement_input.html" with key='add-0' %}
                                    {% endfor %}
                                </div>
                                <div class="row form-group">
                                    <div class="col-md-12 text-center add-object-link">
                                         <a href="#" class="add-planned-disbursement" id=""><span class="glyphicon glyphicon-plus"></span> {% trans 'Add another planned disbursement' %}</a>
                                    </div>
                                </div>
                            </div>
                            {% for customfield in custom_fields_section_6 %}
                                <div id="custom_field-{{ customfield.pk }}">
                                    {% if customfield.type == 'text' %}
                                    <div class="form-group control">
                                        <textarea id="custom-field-{{ customfield.pk }}" class="form-control priority{% if customfield.mandatory %}1{% else %}2{% endif %}" name="custom-field-{{ customfield.pk }}" {% if customfield.max_characters > 0 %}maxlength="{{ customfield.max_characters }}"{% endif %} saved-value="{{ customfield.value }}">{{ customfield.value }}</textarea>
                                        <label class="control-label" for="custom-field-{{ customfield.pk }}">{{ customfield.name }}</label>
                                        {% if customfield.help_text %}<p class="help-block hidden">{{ customfield.help_text|safe }}</p>{% endif %}
                                    </div>
                                    {% elif customfield.type == 'boolean' %}
                                        <div class="form-group control">
                                            <div class="checkbox">
                                                <label for="custom-field-{{ customfield.pk }}" class="control-label">
                                                    <input id="custom-field-{{ customfield.pk }}" type="checkbox" name="custom-field-{{ customfield.pk }}" class="priority2 boolean-custom-field" {% if customfield.value == 'True' %}checked saved-value="True"{% else %}saved-value="False"{% endif %}>
                                                        {{ customfield.name }}
                                                </label>
                                            </div>
                                            {% if customfield.help_text %}
                                                <p class="help-block hidden">{{ customfield.help_text|safe }}</p>
                                            {% endif %}
                                        </div>
                                    {% endif %}
                                </div>
                            {% endfor %}
                            <div class="row form-group">
                                <div class="col-xs-8 col-sm-10" style="text-align: center;" id="savingstep6"></div>
                                <div class="col-xs-4 col-sm-2" style="text-align: right;">
                                    <button type="submit" class="btn btn-success" id="savingstep6-button"><i class="glyphicon glyphicon-save"></i> {% trans 'Save' %}</button>
                                </div>
                            </div>
                            </form>
                        </div>
                    </div>
                </div>
                <!--*************************************** Section 7 **********************************************-->
                <div class="myPanel borderBottom" id="panel7">
                    <div class="formStep stepSeven">
                        <div class="toggleSection">
                            <label for="stepSeven" class="stepLabel"><h4>07 - {% trans 'Project locations' %}<span class="glyphicon glyphicon-info-sign info-icon hidden" onclick="toggleId(event, this, 'step-7-helptext');"></span></h4></label>
                        </div>
                        <input type="radio" name="step" id="stepSeven">
                        <div class="progress section-progress">
                            <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100">
                                <span class="sr-only"></span><span class="progress-percentage"></span>
                            </div>
                        </div>
                        <div class="formBlock hidden">
                            <div class="hidden" id="step-7-helptext">
                                <p class="help-block">{% trans 'The scope of the project refers to the geographical area within which the project is active.' %}</p>
                                <p class="help-block">{% trans 'Also add the physical locations where the project is being carried out. These will appear on the map on your project page. Use the link to' %} <a href="http://mygeoposition.com/" target="_blank">http://mygeoposition.com/</a> {% trans 'to obtain the coordinates for your locations to ensure the pins are correctly placed.' %}</p>
                            </div>
                            <form role="form" id="admin-step-7">
                            <div class="form-group">
                                <div class="select-group control hide-default {% if not advanced_editor %}hidden{% endif %}">
                                    <select name="scope" id="scope" class="form-control priority3" saved-value="{{ project.project_scope }}">
                                        <option value="" {% if not project.project_scope %}selected="selected"{% endif %}></option>
                                        {% for scope in activity_scopes %}
                                            <option value="{{ scope.code }}" {% if project.project_scope == scope.code %} selected="selected" {% endif %}>{{ scope.code }} - {{ scope.name }}</option>
                                        {% endfor %}                                        
                                    </select>
                                    <label for="scope" class="control-label">{% trans 'Project scope' %}</label>
                                    <p class="help-block hidden">{% trans 'Select the geographical scope of the project.' %}</p>
                                </div>
                            </div>
                            <h5>{% trans 'Project locations' %}</h5>
                            <div class="project-location-container" id="project-location-container">
                                {% if project.locations.all %}
                                    {% for location in project.locations.all %}
                                        {% include "myrsr/project_editor/project_location_input.html" with key=location.pk %}
                                    {% endfor %}
                                {% else %}
                                    {% include "myrsr/project_editor/project_location_input.html" with key='add-0' %}
                                {% endif %}
                            </div>
                            <div class="row form-group">
                                <div class="col-md-12 text-center add-object-link">
                                     <a href="#" class="add-project-location" id=""><span class="glyphicon glyphicon-plus"></span> {% trans 'Add another project location' %}</a>
                                </div>
                            </div>
                            <div class="hide-default {% if not advanced_editor %}hidden{% endif %}">
                                <h5>{% trans 'Recipient countries' %}</h5>
                                <div class="recipient-country-container" id="recipient-country-container">
                                    {% for rc in project.recipient_countries.all %}
                                        {% include "myrsr/project_editor/recipient_country_input.html" with key=rc.pk %}
                                    {% empty %}
                                        {% include "myrsr/project_editor/recipient_country_input.html" with key='add-0' %}
                                    {% endfor %}
                                </div>
                                <div class="row form-group">
                                    <div class="col-md-12 text-center add-object-link">
                                         <a href="#" class="add-recipient-country" id=""><span class="glyphicon glyphicon-plus"></span> {% trans 'Add another recipient country' %}</a>
                                    </div>
                                </div>
                                <h5>{% trans 'Recipient regions' %}</h5>
                                <div class="recipient-region-container" id="recipient-region-container">
                                    {% for rr in project.recipient_regions.all %}
                                        {% include "myrsr/project_editor/recipient_region_input.html" with key=rr.pk %}
                                    {% empty %}
                                        {% include "myrsr/project_editor/recipient_region_input.html" with key='add-0' %}
                                    {% endfor %}
                                </div>
                                <div class="row form-group">
                                    <div class="col-md-12 text-center add-object-link">
                                         <a href="#" class="add-recipient-region" id=""><span class="glyphicon glyphicon-plus"></span> {% trans 'Add another recipient region' %}</a>
                                    </div>
                                </div>
                            </div>
                            {% for customfield in custom_fields_section_7 %}
                                <div id="custom_field-{{ customfield.pk }}">
                                    {% if customfield.type == 'text' %}
                                    <div class="form-group control">
                                        <textarea id="custom-field-{{ customfield.pk }}" class="form-control priority{% if customfield.mandatory %}1{% else %}2{% endif %}" name="custom-field-{{ customfield.pk }}" {% if customfield.max_characters > 0 %}maxlength="{{ customfield.max_characters }}"{% endif %} saved-value="{{ customfield.value }}">{{ customfield.value }}</textarea>
                                        <label class="control-label" for="custom-field-{{ customfield.pk }}">{{ customfield.name }}</label>
                                        {% if customfield.help_text %}<p class="help-block hidden">{{ customfield.help_text|safe }}</p>{% endif %}
                                    </div>
                                    {% elif customfield.type == 'boolean' %}
                                        <div class="form-group control">
                                            <div class="checkbox">
                                                <label for="custom-field-{{ customfield.pk }}" class="control-label">
                                                    <input id="custom-field-{{ customfield.pk }}" type="checkbox" name="custom-field-{{ customfield.pk }}" class="priority2 boolean-custom-field" {% if customfield.value == 'True' %}checked saved-value="True"{% else %}saved-value="False"{% endif %}>
                                                        {{ customfield.name }}
                                                </label>
                                            </div>
                                            {% if customfield.help_text %}
                                                <p class="help-block hidden">{{ customfield.help_text|safe }}</p>
                                            {% endif %}
                                        </div>
                                    {% endif %}
                                </div>
                            {% endfor %}
                            <div class="row form-group">
                                <div class="col-xs-8 col-sm-10" style="text-align: center;" id="savingstep7"></div>
                                <div class="col-xs-4 col-sm-2" style="text-align: right;">
                                    <button type="submit" class="btn btn-success" id="savingstep7-button"><i class="glyphicon glyphicon-save"></i> {% trans 'Save' %}</button>
                                </div>
                            </div>
                            </form>
                        </div>
                    </div>
                </div>
                <!--*************************************** Section 8 **********************************************-->
                <div class="myPanel borderBottom" id="panel8">
                    <div class="formStep stepEight">
                        <div class="toggleSection">
                            <label for="stepEight" class="stepLabel"><h4>08 - {% trans 'Project focus' %}<span class="glyphicon glyphicon-info-sign info-icon hidden" onclick="toggleId(event, this, 'step-8-helptext');"></span></h4></label>
                        </div>
                        <input type="radio" name="step" id="stepEight">
                        <div class="progress section-progress">
                            <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100">
                                <span class="sr-only"></span><span class="progress-percentage"></span>
                            </div>
                        </div>
                        <div class="formBlock hidden">
                            <div class="hidden" id="step-8-helptext">
                                <p class="help-block">{% trans 'The project focus aims to define the broad areas of the project activities. This ensures that the project can be collectively grouped by e.g. sector with other similar projects to help make the most out of the project resources. Generally accepted codes are used to help determine these sectors:' %}</p>
                                <p class="help-block">- {% trans 'DAC-3 sector codes which are more general. For reference see:' %} <a href="http://iatistandard.org/201/codelists/SectorCategory/" target="_blank">http://iatistandard.org/201/codelists/SectorCategory/</a>.</p>
                                <p class="help-block">- {% trans 'DAC-5 sector codes which are most detailed. For reference see:' %} <a href="http://iatistandard.org/201/codelists/Sector/" target="_blank">http://iatistandard.org/201/codelists/Sector/</a>.</p>
                            </div>
                            <form role="form" id="admin-step-8">
                            <h5>{% trans 'Sectors' %}</h5>
                            <div class="sector-container" id="sector-container">
                                {% for sector in project.sectors.all %}
                                    {% include "myrsr/project_editor/sector_input.html" with key=sector.pk %}
                                {% empty %}
                                    {% include "myrsr/project_editor/sector_input.html" with key='add-0' %}
                                {% endfor %}
                            </div>
                            <div class="row form-group">
                                <div class="col-md-12 text-center add-object-link">
                                     <a href="#" class="add-sector" id=""><span class="glyphicon glyphicon-plus"></span> {% trans 'Add another sector' %}</a>
                                </div>
                            </div>
                            <div class="hide-default {% if not advanced_editor %}hidden{% endif %}">
                                <h5>{% trans 'Policy markers' %}</h5>
                                <div class="policy-marker-container" id="policy-marker-container">
                                    {% for marker in project.policy_markers.all %}
                                        {% include "myrsr/project_editor/policy_marker_input.html" with key=marker.pk %}
                                    {% empty %}
                                        {% include "myrsr/project_editor/policy_marker_input.html" with key='add-0' %}
                                    {% endfor %}
                                </div>
                                <div class="row form-group">
                                    <div class="col-md-12 text-center add-object-link">
                                         <a href="#" class="add-policy-marker" id=""> <span class="glyphicon glyphicon-plus"></span> {% trans 'Add another policy marker' %}</a>
                                    </div>
                                </div>
                            </div>
                            {% for customfield in custom_fields_section_8 %}
                                <div id="custom_field-{{ customfield.pk }}">
                                    {% if customfield.type == 'text' %}
                                    <div class="form-group control">
                                        <textarea id="custom-field-{{ customfield.pk }}" class="form-control priority{% if customfield.mandatory %}1{% else %}2{% endif %}" name="custom-field-{{ customfield.pk }}" {% if customfield.max_characters > 0 %}maxlength="{{ customfield.max_characters }}"{% endif %} saved-value="{{ customfield.value }}">{{ customfield.value }}</textarea>
                                        <label class="control-label" for="custom-field-{{ customfield.pk }}">{{ customfield.name }}</label>
                                        {% if customfield.help_text %}<p class="help-block hidden">{{ customfield.help_text|safe }}</p>{% endif %}
                                    </div>
                                    {% elif customfield.type == 'boolean' %}
                                        <div class="form-group control">
                                            <div class="checkbox">
                                                <label for="custom-field-{{ customfield.pk }}" class="control-label">
                                                    <input id="custom-field-{{ customfield.pk }}" type="checkbox" name="custom-field-{{ customfield.pk }}" class="priority2 boolean-custom-field" {% if customfield.value == 'True' %}checked saved-value="True"{% else %}saved-value="False"{% endif %}>
                                                        {{ customfield.name }}
                                                </label>
                                            </div>
                                            {% if customfield.help_text %}
                                                <p class="help-block hidden">{{ customfield.help_text|safe }}</p>
                                            {% endif %}
                                        </div>
                                    {% endif %}
                                </div>
                            {% endfor %}
                            <div class="row form-group">
                                <div class="col-xs-8 col-sm-10" style="text-align: center;" id="savingstep8"></div>
                                <div class="col-xs-4 col-sm-2" style="text-align: right;">
                                    <button type="submit" class="btn btn-success" id="savingstep8-button"><i class="glyphicon glyphicon-save"></i> {% trans 'Save' %}</button>
                                </div>
                            </div>
                            </form>
                        </div>
                    </div>
                </div>
                <!--*************************************** Section 9 **********************************************-->
                <div class="myPanel borderBottom" id="panel9">
                    <div class="formStep stepNine">
                        <div class="toggleSection">
                            <label for="stepNine" class="stepLabel"><h4>09 - {% trans 'Links and documents' %}<span class="glyphicon glyphicon-info-sign info-icon hidden" onclick="toggleId(event, this, 'step-9-helptext');"></span></h4></label>
                        </div>
                        <input type="radio" name="step" id="stepNine">                        
                        <div class="progress section-progress">
                            <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100">
                                <span class="sr-only"></span><span class="progress-percentage"></span>
                            </div>
                        </div>
                        <div class="formBlock hidden">
                            <p class="help-block hidden" id="step-9-helptext">{% trans 'You can add any additional supporting documents to your project or links to external websites here. This could be in the form of annual reports, baseline surveys, contextual information or any other report that can help users understand more about the project’s activities.' %}</p>
                            <form role="form" id="admin-step-9">
                            <h5>{% trans 'Links' %}</h5>
                            <div class="form-group">
                                <div class="link-container" id="link-container">
                                    {% for link in project.links.all %}
                                        {% include "myrsr/project_editor/link_input.html" with key=link.pk %}
                                    {% empty %}
                                        {% include "myrsr/project_editor/link_input.html" with key='add-0' %}
                                    {% endfor %}
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-md-12 text-center add-object-link">
                                     <a href="#" class="add-link" id=""><span class="glyphicon glyphicon-plus"></span> {% trans 'Add another link' %}</a>
                                </div>
                            </div>
                            <h5>{% trans 'Document links' %}</h5>
                            <div class="document-container" id="document-container">
                                {% for document in project.documents.all %}
                                    {% include "myrsr/project_editor/document_input.html" with key=document.pk %}
                                {% empty %}
                                    {% include "myrsr/project_editor/document_input.html" with key='add-0' %}
                                {% endfor %}
                            </div>
                            <div class="row form-group">
                                <div class="col-md-12 text-center add-object-link">
                                     <a href="#" class="add-document" id=""><span class="glyphicon glyphicon-plus"></span> {% trans 'Add another document' %}</a>
                                </div>
                            </div>
                            {% for customfield in custom_fields_section_9 %}
                                <div id="custom_field-{{ customfield.pk }}">
                                    {% if customfield.type == 'text' %}
                                    <div class="form-group control">
                                        <textarea id="custom-field-{{ customfield.pk }}" class="form-control priority{% if customfield.mandatory %}1{% else %}2{% endif %}" name="custom-field-{{ customfield.pk }}" {% if customfield.max_characters > 0 %}maxlength="{{ customfield.max_characters }}"{% endif %} saved-value="{{ customfield.value }}">{{ customfield.value }}</textarea>
                                        <label class="control-label" for="custom-field-{{ customfield.pk }}">{{ customfield.name }}</label>
                                        {% if customfield.help_text %}<p class="help-block hidden">{{ customfield.help_text|safe }}</p>{% endif %}
                                    </div>
                                    {% elif customfield.type == 'boolean' %}
                                        <div class="form-group control">
                                            <div class="checkbox">
                                                <label for="custom-field-{{ customfield.pk }}" class="control-label">
                                                    <input id="custom-field-{{ customfield.pk }}" type="checkbox" name="custom-field-{{ customfield.pk }}" class="priority2 boolean-custom-field" {% if customfield.value == 'True' %}checked saved-value="True"{% else %}saved-value="False"{% endif %}>
                                                        {{ customfield.name }}
                                                </label>
                                            </div>
                                            {% if customfield.help_text %}
                                                <p class="help-block hidden">{{ customfield.help_text|safe }}</p>
                                            {% endif %}
                                        </div>
                                    {% endif %}
                                </div>
                            {% endfor %}
                            <div class="row form-group">
                                <div class="col-xs-8 col-sm-10" style="text-align: center;" id="savingstep9"></div>
                                <div class="col-xs-4 col-sm-2" style="text-align: right;">
                                    <button type="submit" class="btn btn-success" id="savingstep9-button"><i class="glyphicon glyphicon-save"></i> {% trans 'Save' %}</button>
                                </div>
                            </div>
                            </form>
                        </div>
                    </div>
                </div>
                <!--*************************************** Section 10 **********************************************-->
                <div class="myPanel borderBottom" id="panel10">
                    <div class="formStep stepTen">
                        <div class="toggleSection">
                            <label for="stepTen" class="stepLabel"><h4>10 - {% trans 'Project comments and keywords' %}<span class="glyphicon glyphicon-info-sign info-icon hidden" onclick="toggleId(event, this, 'step-10-helptext');"></span></h4></label>
                        </div>
                        <input type="radio" name="step" id="stepTen">
                        <div class="progress section-progress">
                            <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100">
                                <span class="sr-only"></span><span class="progress-percentage"></span>
                            </div>
                        </div>
                        <div class="formBlock hidden">
                            <p class="help-block hidden" id="step-10-helptext">{% trans 'Fill in comments regarding the project. These are only for internal use and will not be displayed anywhere on the project page.' %}</p>
                            <form role="form" id="admin-step-10">
                            <div class="form-group control">
                                <textarea id="projectComments" class="form-control priority2" name="projectComments" rows="8" saved-value="{{ project.notes }}">{{ project.notes }}</textarea>
                                <label class="control-label" for="projectComments">{% trans 'Project comments' %}</label>
                                <p class="help-block hidden">{% trans 'The project comments are only for internal use and will not be displayed anywhere on the project page.' %}</p>
                            </div>
                            <h5>{% trans 'Keywords' %}</h5>
                            <div class="keyword-container" id="keyword-container">
                                {% for keyword in project.keywords.all %}
                                    {% include "myrsr/project_editor/keyword_input.html" with key=keyword.pk %}
                                {% empty %}
                                    {% include "myrsr/project_editor/keyword_input.html" with key='add-0' %}
                                {% endfor %}
                            </div>
                            <div class="row form-group">
                                <div class="col-md-12 text-center add-object-link">
                                     <a href="#" class="add-keyword" id=""><span class="glyphicon glyphicon-plus"></span> {% trans 'Add another keyword' %}</a>
                                </div>
                            </div>
                            {% for customfield in custom_fields_section_10 %}
                                <div id="custom_field-{{ customfield.pk }}">
                                    {% if customfield.type == 'text' %}
                                    <div class="form-group control">
                                        <textarea id="custom-field-{{ customfield.pk }}" class="form-control priority{% if customfield.mandatory %}1{% else %}2{% endif %}" name="custom-field-{{ customfield.pk }}" {% if customfield.max_characters > 0 %}maxlength="{{ customfield.max_characters }}"{% endif %} saved-value="{{ customfield.value }}">{{ customfield.value }}</textarea>
                                        <label class="control-label" for="custom-field-{{ customfield.pk }}">{{ customfield.name }}</label>
                                        {% if customfield.help_text %}<p class="help-block hidden">{{ customfield.help_text|safe }}</p>{% endif %}
                                    </div>
                                    {% elif customfield.type == 'boolean' %}
                                        <div class="form-group control">
                                            <div class="checkbox">
                                                <label for="custom-field-{{ customfield.pk }}" class="control-label">
                                                    <input id="custom-field-{{ customfield.pk }}" type="checkbox" name="custom-field-{{ customfield.pk }}" class="priority2 boolean-custom-field" {% if customfield.value == 'True' %}checked saved-value="True"{% else %}saved-value="False"{% endif %}>
                                                        {{ customfield.name }}
                                                </label>
                                            </div>
                                            {% if customfield.help_text %}
                                                <p class="help-block hidden">{{ customfield.help_text|safe }}</p>
                                            {% endif %}
                                        </div>
                                    {% endif %}
                                </div>
                            {% endfor %}
                            <div class="row form-group">
                                <div class="col-xs-8 col-sm-10" style="text-align: center;" id="savingstep10"></div>
                                <div class="col-xs-4 col-sm-2" style="text-align: right;">
                                    <button type="submit" class="btn btn-success" id="savingstep10-button"><i class="glyphicon glyphicon-save"></i> {% trans 'Save' %}</button>
                                </div>
                            </div>
                            </form>
                        </div>
                    </div>
                </div>
            </fieldset>
        </form>
        {% endwith %}
    </section>
    <div id="editor-feedback" class="hidden-xs">
        <script type="text/javascript">
            document.write(
                // Encrypt email address for spam bots
                unescape('%3C%61%20%68%72%65%66%3D%22%6D%61%69%6C%74%6F%3A%72%73%72%2E%66%65%65%64%62%61%63%6B%40%61%6B%76%6F%2E%6F%72%67%3F%73%75%62%6A%65%63%74%3D%52%53%52%20%66%65%65%64%62%61%63%6B%26%62%6F%64%79%3D%54%68%61%6E%6B%73%20%61%20%6C%6F%74%20%66%6F%72%20%67%69%76%69%6E%67%20%75%73%20%66%65%65%64%62%61%63%6B%20%61%62%6F%75%74%20%74%68%65%20%6E%65%77%20%70%72%6F%6A%65%63%74%20%65%64%69%74%6F%72%2E%20%54%68%69%73%20%68%65%6C%70%73%20%75%73%20%77%69%74%68%20%74%68%65%20%63%6F%6E%74%69%6E%75%6F%75%73%20%69%6D%70%72%6F%76%65%6D%65%6E%74%20%6F%66%20%52%53%52%2E%20%50%6C%65%61%73%65%20%70%72%6F%76%69%64%65%20%75%73%20%61%74%20%6C%65%61%73%74%20%74%68%65%20%66%6F%6C%6C%6F%77%69%6E%67%20%69%6E%66%6F%72%6D%61%74%69%6F%6E%3A%25%30%44%25%30%41%25%30%44%25%30%41%59%6F%75%72%20%70%72%6F%6A%65%63%74%3A%25%30%44%25%30%41%50%6F%73%69%74%69%76%65%20%61%62%6F%75%74%20%74%68%65%20%6E%65%77%20%70%72%6F%6A%65%63%74%20%65%64%69%74%6F%72%3A%25%30%44%25%30%41%54%68%69%73%20%63%6F%75%6C%64%20%62%65%20%69%6D%70%72%6F%76%65%64%3A%25%30%44%25%30%41%47%65%6E%65%72%61%6C%20%72%65%6D%61%72%6B%73%3A%22%3E%3C%69%20%63%6C%61%73%73%3D%22%66%61%20%66%61%2D%63%6F%6D%6D%65%6E%74%2D%6F%22%3E%3C%2F%69%3E')
            );
        </script>
        {% trans 'Provide feedback' %}
        <script type="text/javascript">
            document.write(
                "<\057n>".replace(/[a-zA-Z]/g, function(c){return String.fromCharCode((c<="Z"?90:122)>=(c=c.charCodeAt(0)+13)?c:c-26);})
            );
        </script>
    </div>
{% endblock %}

{% block js %}
    {{ block.super }}
    <script type="application/javascript" src="http://form-serialize.googlecode.com/svn/trunk/serialize-0.2.min.js"></script>

    {% with text_input="myrsr/project_editor/fields/text_input.html" textarea_input="myrsr/project_editor/fields/textarea_input.html" choice_input="myrsr/project_editor/fields/choice_input.html" typeahead_input="myrsr/project_editor/fields/typeahead_input.html" currency_input="myrsr/project_editor/fields/currency_input.html" %}
        {# Section 1 #}
        <script type="text/template" id="related-project-input">{% include "myrsr/project_editor/section_1/related_project_input.html" with rp='RelatedProject.1205' %}</script>

        {# Section 2 #}
        <script type="text/template" id="contact-information-input">{% include "myrsr/project_editor/section_2/contact_information_input.html" with contact='ProjectContact.1205' %}</script>

        {# Section 3 #}
        <script type="text/template" id="partner-input">{% include "myrsr/project_editor/section_3/partner_input.html" with ps='Partnership.1205' %}</script>

        <script type="text/template" id="budget-item-input">{% include "myrsr/project_editor/budget_item_input.html" %}</script>
        <script type="text/template" id="condition-input">{% include "myrsr/project_editor/condition_input.html" %}</script>
        <script type="text/template" id="country-budget-item-input">{% include "myrsr/project_editor/country_budget_item_input.html" %}</script>
        <script type="text/template" id="document-input">{% include "myrsr/project_editor/document_input.html" %}</script>
        <script type="text/template" id="indicator-input">{% include "myrsr/project_editor/indicator_input.html" %}</script>
        <script type="text/template" id="indicator-period-input">{% include "myrsr/project_editor/indicator_period_input.html" %}</script>
        <script type="text/template" id="keyword-input">{% include "myrsr/project_editor/keyword_input.html" %}</script>
        <script type="text/template" id="link-input">{% include "myrsr/project_editor/link_input.html" %}</script>
        <script type="text/template" id="project-location-input">{% include "myrsr/project_editor/project_location_input.html" %}</script>
        <script type="text/template" id="location-administrative-input">{% include "myrsr/project_editor/location_administrative_input.html"%}</script>
        <script type="text/template" id="planned-disbursement-input">{% include "myrsr/project_editor/planned_disbursement_input.html" %}</script>
        <script type="text/template" id="policy-marker-input">{% include "myrsr/project_editor/policy_marker_input.html" %}</script>
        <script type="text/template" id="recipient-country-input">{% include "myrsr/project_editor/recipient_country_input.html" %}</script>
        <script type="text/template" id="recipient-region-input">{% include "myrsr/project_editor/recipient_region_input.html" %}</script>
        <script type="text/template" id="result-input">{% include "myrsr/project_editor/result_input.html" %}</script>
        <script type="text/template" id="sector-input">{% include "myrsr/project_editor/sector_input.html" %}</script>
        <script type="text/template" id="transaction-input">{% include "myrsr/project_editor/transaction_input.html" %}</script>
        <script type="text/template" id="transaction-sector-input">{% include "myrsr/project_editor/transaction_sector_input.html" %}</script>
    {% endwith %}
 
    {% block react_js %}
        <script src="//fb.me/react-0.12.0.js"></script>
    {% endblock react_js %}

    <script type="application/json" id="default-values">
        {
            "project_id": "{{ project.pk }}",
            "publishing_status_id": "{{ project.publishingstatus.pk }}",
            "user_id": "{{ user.pk }}",
            "view_project": "{% trans 'View project page' %}",
            "preview_project": "{% trans 'Preview project page' %}",
            "related_project_label": "{% trans 'Related RSR project' %}",
            "related_project_helptext": "{% trans 'When your project has related projects in the RSR database, you can link them here to create a hierarchy, by filling in the project title. It is possible to link multiple projects.' %}",
            "partner_label": "{% trans 'Project partner' %}",
            "partner_helptext": "{% trans 'Select an organisation that is playing a role in the project.  If an organisation is not currently featured in RSR, please contact' %} <a href='mailto:support@akvo.org'>support@akvo.org</a> {% trans 'to request to add it to the database.' %}",
            "provider_org_label": "{% trans 'Provider organisation' %}",
            "provider_org_helptext": "{% trans 'For incoming funds, this is the organisation from which the transaction originated. It will default to the reporting organisation.' %}",
            "recipient_org_label": "{% trans 'Recipient organisation' %}",
            "recipient_org_helptext": "{% trans 'The organisation that receives the incoming funds.' %}",
            "add_new_organisation": "{% trans 'Add new organisation' %}",
            "name": "{% trans 'Name' %}",
            "long_name": "{% trans 'Long name' %}",
            "iati_org_id": "{% trans 'Organisation IATI identifier' %}",
            "org_type": "{% trans 'Organisation type' %}",
            "description": "{% trans 'Description' %}",
            "cancel": "{% trans 'Cancel' %}",
            "max": "{% trans 'Max' %}",
            "characters": "{% trans 'characters' %}",
            "blank_name": "{% trans 'Organisation name can not be blank' %}",
            "blank_long_name": "{% trans 'Organisation long name can not be blank' %}",
            "government": "{% trans 'Government' %}",
            "other_public_sector": "{% trans 'Other Public Sector' %}",
            "international_ngo": "{% trans 'International NGO' %}",
            "national_ngo": "{% trans 'National NGO' %}",
            "regional_ngo": "{% trans 'Regional NGO' %}",
            "public_private_partnership": "{% trans 'Public Private Partnership' %}",
            "multilateral": "{% trans 'Multilateral' %}",
            "foundation": "{% trans 'Foundation' %}",
            "private_sector": "{% trans 'Private Sector' %}",
            "academic_training_research": "{% trans 'Academic, Training and Research' %}",
            "website": "{% trans 'Website' %}",
            "start_http": "{% trans 'The URL of the website must begin with http://' %}",
            "contact_person": "{% trans 'Contact name' %}",
            "contact_email": "{% trans 'Contact email' %}",
            "longitude": "{% trans 'Longitude' %}",
            "latitude": "{% trans 'Latitude' %}",
            "country": "{% trans 'Country' %}",
            "use_link": "{% trans 'Use the link to' %}",
            "coordinates": "{% trans 'to obtain the coordinates for your locations to ensure the pins are correctly placed.' %}",
            "org_logo": "{% trans 'Organisation logo' %}",
            "location_check": "{% trans 'All location fields have to be filled in' %}",
            "general_error": "{% trans 'Something went wrong while adding the organisation' %}",
            "comma_value": "{% trans 'It is not allowed to use a comma, use a period to denote decimals' %}",
            "image_file_format": "{% trans 'File is not an image file. Supported formats are' %}",
            "file_size": "{% trans 'File size is too large' %}",
            "file_size_allowed": "{% trans 'Maximum file size allowed is' %}",
            "connection_error": "{% trans 'Connection error, please check your internet connection' %}"
        }
    </script>

    <script type="application/json" id="country-values">
        [{% for country in countries %}{"pk": "{{ country.pk }}", "name": "{{ country.name }}"}{% if not forloop.last %},{% endif %}{% endfor %}]
    </script>

    <script type="application/json" id="sector-values">
        [{% for sector_code in sector_codes %}{"code": "{{ sector_code.code }}", "name": "{{ sector_code.name|title }}"}{% if not forloop.last %},{% endif %}{% endfor %}]
    </script>

    <script type="application/json" id="sector-category-values">
        [{% for sector_cat_code in sector_category_codes %}{"code": "{{ sector_cat_code.code }}", "name": "{{ sector_cat_code.name|title }}"}{% if not forloop.last %},{% endif %}{% endfor %}]
    </script>

    <script type="application/javascript">
        function toggleFunding(node) {
            var fundingInputNode, fundingNode, parentNode, labelNode, mandatoryNodes, span;

            parentNode = node.parentNode.parentNode.parentNode;
            fundingInputNode = parentNode.getElementsByTagName("input")[1];
            fundingNode = fundingInputNode.parentNode.parentNode;

            if (node.options[node.selectedIndex].value === '1') {
                fundingInputNode.removeAttribute('disabled');
                fundingInputNode.className += ' mandatory-rsr';

                labelNode = fundingNode.getElementsByTagName('label')[0];
                span = document.createElement('span');
                span.className = 'mandatory';
                span.innerHTML = '*';
                labelNode.insertBefore(span, labelNode.getElementsByTagName('span')[0]);
            } else {
                fundingInputNode.value = '';
                fundingInputNode.setAttribute('disabled', '');
                fundingInputNode.className = fundingInputNode.className.replace('mandatory-rsr', '');

                mandatoryNodes = fundingNode.getElementsByClassName('mandatory');
                if (mandatoryNodes.length > 0) {
                    mandatoryNodes[0].parentNode.removeChild(mandatoryNodes[0]);
                }
            }
        }

        function toggleOtherLabel(node) {
            var otherLabelNode, parentNode;

            parentNode = node.parentNode.parentNode.parentNode;
            otherLabelNode = parentNode.getElementsByTagName("input")[0];

            if (node.options[node.selectedIndex].text === 'Other') {
                otherLabelNode.removeAttribute('disabled');
                otherLabelNode.className += ' mandatory-rsr';
            } else {
                otherLabelNode.value = '';
                otherLabelNode.setAttribute('disabled', '');
                otherLabelNode.className = otherLabelNode.className.replace('mandatory-rsr', '');
            }
        }

        function toggleId(e, helpIconNode, nodeId) {
            e.stopPropagation && e.stopPropagation() || (e.cancelBubble = true);

            var node;

            node = document.getElementById(nodeId);

            if (node.className.indexOf("hidden") > -1) {
                node.className = node.className.replace('hidden', '');
                helpIconNode.className += ' activated';
            } else {
                node.className += ' hidden';
                helpIconNode.className = helpIconNode.className.replace('activated', '');
            }
        }

        function toggleSectors(node) {
            var optionNode, sectorCodeId, sectorCodeNode, sectorCode, sectorCodes;

            sectorCodeId = node.getAttribute('id').replace('vocabulary', 'code');
            sectorCodeNode = document.getElementById(sectorCodeId);

            if (node.value == '') {
                // No vocabulary selected, do nothing
            } else if (node.value == '1') {
                // DAC-5 selected
                if (sectorCodeNode.getAttribute('displayed-options') != '1') {
                    sectorCodes = JSON.parse(document.getElementById("sector-values").innerHTML);

                    while (sectorCodeNode.firstChild) {
                        sectorCodeNode.removeChild(sectorCodeNode.firstChild);
                    }

                    optionNode = document.createElement('option');
                    optionNode.setAttribute('value', '');
                    sectorCodeNode.appendChild(optionNode);

                    for (var i=0; i < sectorCodes.length; i++) {
                        sectorCode = sectorCodes[i];

                        optionNode = document.createElement('option');
                        optionNode.setAttribute('value', sectorCode.code);
                        optionNode.innerHTML = sectorCode.code + ' - ' + sectorCode.name;

                        sectorCodeNode.appendChild(optionNode);
                    }

                    sectorCodeNode.setAttribute('displayed-options', '1');
                }
            } else if (node.value == '2') {
                // DAC-3 selected
                if (sectorCodeNode.getAttribute('displayed-options') != '2') {
                    sectorCodes = JSON.parse(document.getElementById("sector-category-values").innerHTML);

                    while (sectorCodeNode.firstChild) {
                        sectorCodeNode.removeChild(sectorCodeNode.firstChild);
                    }

                    optionNode = document.createElement('option');
                    optionNode.setAttribute('value', '');
                    sectorCodeNode.appendChild(optionNode);

                    for (var j=0; j < sectorCodes.length; j++) {
                        sectorCode = sectorCodes[j];

                        optionNode = document.createElement('option');
                        optionNode.setAttribute('value', sectorCode.code);
                        optionNode.innerHTML = sectorCode.code + ' - ' + sectorCode.name;

                        sectorCodeNode.appendChild(optionNode);
                    }

                    sectorCodeNode.setAttribute('displayed-options', '2');
                }
            }
        }

        function toggleDocumentUpload(node) {
            var documentUpload, documentUrl, parentNode;

            parentNode = node.parentNode.parentNode.parentNode;
            documentUpload = parentNode.querySelectorAll('.show-document-upload')[0];
            documentUrl = parentNode.querySelectorAll('.show-document-url')[0];

            if (node.checked) {
                // User wants to upload document
                if (documentUrl.className.indexOf('hidden') === -1) {
                    documentUrl.className += ' hidden';
                }

                if (documentUpload.className.indexOf('hidden') > -1) {
                    documentUpload.className = documentUpload.className.replace('hidden', '');
                }
            } else {
                // User wants to indicate URL
                if (documentUpload.className.indexOf('hidden') === -1) {
                    documentUpload.className += ' hidden';
                }

                if (documentUrl.className.indexOf('hidden') > -1) {
                    documentUrl.className = documentUrl.className.replace('hidden', '');
                }
            }
        }

        function toggleDocumentUploadHelptext(node) {
            var helpText = node.parentNode.parentNode.parentNode.querySelectorAll('.help-block')[0];

            if (node.className.indexOf('activated') === -1) {
                node.className += ' activated';
                helpText.className = helpText.className.replace('hidden', '');

            } else {
                node.className = node.className.replace('activated', '');
                helpText.className += ' hidden';
            }
        }

        function toggleRelatedProject(node) {
            var relatedProject, IatiIdentifier, parentNode;

            parentNode = node.parentNode.parentNode.parentNode;
            relatedProject = parentNode.querySelectorAll('.related-project-input')[0];
            IatiIdentifier = parentNode.querySelectorAll('.related-project-iati-identifier-container')[0];

            if (node.checked) {
                // User wants to indicate IATI identifier
                if (relatedProject.className.indexOf('hidden') === -1) {
                    relatedProject.className += ' hidden';
                }

                if (IatiIdentifier.className.indexOf('hidden') > -1) {
                    IatiIdentifier.className = IatiIdentifier.className.replace('hidden', '');
                }
            } else {
                // User wants to link to related project
                if (IatiIdentifier.className.indexOf('hidden') === -1) {
                    IatiIdentifier.className += ' hidden';
                }

                if (relatedProject.className.indexOf('hidden') > -1) {
                    relatedProject.className = relatedProject.className.replace('hidden', '');
                }
            }
        }

{#        function toggleRelatedProjectHelptext(node) {#}
{#            var helpText = node.parentNode.parentNode.querySelectorAll('.help-block')[0];#}
{##}
{#            if (node.className.indexOf('activated') === -1) {#}
{#                node.className += ' activated';#}
{#                helpText.className = helpText.className.replace('hidden', '');#}
{##}
{#            } else {#}
{#                node.className = node.className.replace('activated', '');#}
{#                helpText.className += ' hidden';#}
{#            }#}
{#        }#}

        function toggleStartDate(node) {
            var startDateActual, startDatePlanned, startDateActualInput, startDatePlannedInput, startDateActualLabel, startDatePlannedLabel, mandatoryNode;

            startDateActual = document.getElementById('actual-start-date-container');
            startDatePlanned = document.getElementById('planned-start-date-container');
            startDateActualInput = startDateActual.getElementsByTagName('input')[0];
            startDatePlannedInput = startDatePlanned.getElementsByTagName('input')[0];
            startDateActualLabel = startDateActual.getElementsByTagName('label')[0];
            startDatePlannedLabel = startDatePlanned.getElementsByTagName('label')[0];

            mandatoryNode = document.createElement('span');
            mandatoryNode.className = 'mandatory';
            mandatoryNode.innerHTML= '*';

            if (node.checked) {
                // Show actual start date, as mandatory field
                if (startDatePlanned.className.indexOf('hidden') === -1) {
                    startDatePlanned.className += ' hidden';
                    startDatePlannedInput.className = startDatePlannedInput.className.replace('mandatory-rsr', 'priority2');
                }

                if (startDateActual.className.indexOf('hidden') > -1) {
                    startDateActual.className = startDateActual.className.replace('hidden', '');
                    startDateActualInput.className = startDateActualInput.className.replace('priority2', 'mandatory-rsr');
                }

                startDateActualLabel.insertBefore(mandatoryNode, startDateActualLabel.getElementsByTagName('span')[0]);
                var plannedMandatory = startDatePlannedLabel.getElementsByClassName('mandatory')[0];
                plannedMandatory.parentNode.removeChild(plannedMandatory);
            } else {
                // Show planned start date, as mandatory field
                if (startDateActual.className.indexOf('hidden') === -1) {
                    startDateActual.className += ' hidden';
                    startDateActualInput.className = startDateActualInput.className.replace('mandatory-rsr', 'priority2');
                }

                if (startDatePlanned.className.indexOf('hidden') > -1) {
                    startDatePlanned.className = startDatePlanned.className.replace('hidden', '');
                    startDatePlannedInput.className = startDatePlannedInput.className.replace('priority2', 'mandatory-rsr');
                }

                startDatePlannedLabel.insertBefore(mandatoryNode, startDatePlannedLabel.getElementsByTagName('span')[0]);
                var actualMandatory = startDateActualLabel.getElementsByClassName('mandatory')[0];
                actualMandatory.parentNode.removeChild(actualMandatory);
            }
        }

        function toggleEndDate(node) {
            var endDateActual, endDatePlanned;

            endDateActual = document.getElementById('actual-end-date-container');
            endDatePlanned = document.getElementById('planned-end-date-container');

            if (node.checked) {
                // Show actual end date
                if (endDatePlanned.className.indexOf('hidden') === -1) {
                    endDatePlanned.className += ' hidden';
                }

                if (endDateActual.className.indexOf('hidden') > -1) {
                    endDateActual.className = endDateActual.className.replace('hidden', '');
                }
            } else {
                // Show planned end date
                if (endDateActual.className.indexOf('hidden') === -1) {
                    endDateActual.className += ' hidden';
                }

                if (endDatePlanned.className.indexOf('hidden') > -1) {
                    endDatePlanned.className = endDatePlanned.className.replace('hidden', '');
                }
            }
        }
    </script>

    <script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js"></script>

    {% compressed_css 'react_datepicker_style' %}

    {% compressed_js 'react_typeahead' %}
    <script type="application/javascript" src="{{ STATIC_URL }}lib/scripts/react-onclickoutside.js"></script>
    <script type="application/javascript" src="{{ STATIC_URL }}lib/scripts/react-datepicker-compat.js"></script>
    {% compressed_js 'myrsr_admin' %}
{% endblock %}
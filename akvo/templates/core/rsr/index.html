{% extends "rsr/base.html" %}

{% load i18n generic_content thumbnail rsr_filters rsr_tags humanize %}


{% block content %}

<h2>Staff picks</h2>
<div class="span-18">
	<div class="span-5 first">
		<h3><a href="{% url project_updates updates.0.project.id %}#{{updates.0.id}}">{{updates.0.title}}</a></h3>
		<p>
			{{updates.0.project.country}}
		</p>
		<a href="{% url project_updates updates.0.project.id %}#{{updates.0.id}}">
			<img src="{% thumbnail updates.0.photo 195x146 autocrop sharpen %}" style="margin-top:10px; margin-left:auto; margin-right:auto;" alt="" />
		</a>
	</div>

	<div class="span-5">
		<h3><a href="{% url project_updates updates.1.project.id %}#{{updates.1.id}}">{{updates.1.title}}</a></h3>
		<p>
			{{updates.1.project.country}}
		</p>
		<a href="{% url project_updates updates.1.project.id %}#{{updates.1.id}}">
			<img src="{% thumbnail updates.1.photo 195x146 autocrop sharpen %}" style="margin-top:10px; margin-left:auto; margin-right:auto;" alt="" />
		</a>
	</div>

	<div class="span-5">
		<h3><a href="{% url project_updates updates.2.project.id %}#{{updates.2.id}}">{{updates.2.title}}</a></h3>
		<p>
			{{updates.2.project.country}}
		</p>
		<a href="{% url project_updates updates.2.project.id %}#{{updates.2.id}}">
			<img src="{% thumbnail updates.2.photo 195x146 autocrop sharpen %}" style="margin-top:10px; margin-left:auto; margin-right:auto;" alt="" />
		</a>
	</div>

	<div class="span-3 last">
		&nbsp;
	</div>
</div>
<div class="span-18" style="height:60px;">
	&nbsp;
</div>
<div class="span-18">
	<h2>Stats (at a glance)</h2>

	<table class="overall_statistics" border="0" cellspacing="0" cellpadding="0">
		<tr>
			<th colspan="2">
				{% ifequal request.path '/rsr/projects/' %}
				<h2>{% trans 'Projects in Akvo' %}</h2>
				{% else %}
					<a href="{% url akvo.rsr.views.projectlist %}">
						<h2>{% trans 'Projects in Akvo' %}</h2>
					</a>
				{% endifequal %}
			</th>
		</tr>
		<tr>
			<td>
				{% trans 'Active' %}
			</td>
			<td style="text-align:right;">
				{{projs.status_active.count}}
			</td>
		</tr>
		<tr>
			<td>
				{% trans 'Need funding' %}
			</td>
			<td style="text-align:right;">
				{{projs.status_onhold.count}}
			</td>
		</tr>
		<tr>
			<td>
				{% trans 'Complete' %}
			</td>
			<td style="text-align:right;">
				{{projs.status_complete.count}}
			</td>
		</tr>
		<tr>
			<td>
				{% trans 'Cancelled' %}
			</td>
			<td style="text-align:right;">
				{{projs.status_cancelled.count}}
			</td>
		</tr>
		<tr class="hr bold">
			<td style="padding-top:2px; padding-bottom:20px;">
				{% trans 'Total projects' %}
			</td>
			<td style="text-align:right; padding-top:3px;">
				{{projs.published.count}}
			</td>
		</tr>
	</table>
	<table class="overall_statistics" border="0" cellspacing="0" cellpadding="0" style="margin-top:10px;"> 	
		<tr>
			<th colspan="3">
				<h2>{% trans 'People who get...' %}</h2>
			</th>
		</tr>
		<tr>
			<td style="width:50px;">&nbsp;</td>
			<td style="font-size:0.9em; width:80px; text-align:right;"><a href="/web/help_akvo_at_a_glance">{% trans 'Upcoming' %}</a></td>
			<td style="font-size:0.9em; width:80px; text-align:right;"><a href="/web/help_akvo_at_a_glance">{% trans 'Delivered' %}</a></td>
		</tr>
		<tr>
			<td style="font-weight:bold;">{% trans 'Water' %}</td>
			<td style="text-align:right;">{{projs.get_planned_water_calc|intcomma}}</td>
			<td style="text-align:right;">{{projs.get_actual_water_calc|intcomma}}</td>
		</tr>
		<tr class="hr">
			<td style="font-weight:bold; padding-bottom:20px;">{% trans 'Sanitation' %}</td>
			<td style="text-align:right;">{{projs.get_planned_sanitation_calc|intcomma}}</td>
			<td style="text-align:right;">{{projs.get_actual_sanitation_calc|intcomma}}</td>
		</tr>
	</table>
	<table class="overall_statistics" border="0" cellspacing="0" cellpadding="0" style="margin-top:10px;">	
		<tr>
			<th colspan="3">
				{% ifequal request.path '/rsr/organisations/' %}
					<h2>{% trans 'Project Partners' %}</h2>
				{% else %}
					<a href="{% url akvo.rsr.views.orglist %}">
						<h2>{% trans 'Project Partners' %}</h2>
					</a>
				{% endifequal %}
			</th>
		</tr>
		<tr class="bold">
			<td colspan="2" style="padding-bottom:5px;">{% trans 'Total organisations' %}</td>
			<td colspan="2" style="text-align:right;">{{orgs.all.count}}</td>
		</tr>
		<tr>
			<td style="width:50%;"><a href="{% url rsr_org_list_filtered "field" %}">{% trans 'Field partners' %}</a></td>
			<td style="text-align:right; width:25%;">{{orgs.fieldpartners.count}}</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td><a href="{% url rsr_org_list_filtered "support" %}">{% trans 'Support partners' %}</a></td>
			<td style="text-align:right;">{{orgs.supportpartners.count}}</td>
			<td>&nbsp;</td>
		</tr>
		<tr class="hr">
			<td style="padding-bottom:20px;"><a href="{% url rsr_org_list_filtered "funding" %}">{% trans 'Funding partners' %}</a></td>
			<td style="text-align:right;">{{orgs.fundingpartners.count}}</td>
			<td>&nbsp;</td>
		</tr>
	</table>
	<table class="overall_statistics" border="0" cellspacing="0" cellpadding="0" style="margin-top:20px;">	
		<tr class="font-weight:bold;">
			<th colspan="2" style="padding-bottom:10px;">
				{% trans 'Funding' %} {#<span style="font-weight:normal; color:#999">({{projs.published.count}} {% trans 'Projects' %})</span>#}
			</th>
		</tr>
		<tr>
			<td>{{projs.status_not_cancelled.euros.count}} project{{projs.status_not_cancelled.euros.count|pluralize:"s"}} in Euros</td>
		</tr>
		<tr style="color:green;">
			<td>{% trans 'Raised' %}</td>
			<td style="text-align:right;">{{projs.euros.0.get_currency_display|safe}} {{projs.status_not_cancelled.euros.total_pledged|add:projs.status_not_cancelled.euros.total_donated|round|intcomma}}</td>
		</tr>
		<tr style="color:red;">
			<td style="padding-bottom:5px;">{% trans 'Still needed' %}</td>
			<td style="text-align:right;">{{projs.euros.0.get_currency_display|safe}} {{projs.status_not_cancelled.euros.total_funds_needed|round|intcomma}}</td>
		</tr>
		{% if projs.status_not_cancelled.dollars.count %}
		<tr>
			<td>{{projs.status_not_cancelled.dollars.count}} project{{projs.status_not_cancelled.dollars.count|pluralize:"s"}} in US Dollars</td>
		</tr>
		<tr style="color:green;">
			<td>{% trans 'Raised' %}</td>
			<td style="text-align:right;">{{projs.dollars.0.get_currency_display|safe}} {{projs.status_not_cancelled.dollars.total_pledged|add:projs.status_not_cancelled.dollars.total_donated|round|intcomma}}</td>
		</tr>
		<tr style="color:red;">
			<td style="padding-bottom:5px;">{% trans 'Still needed' %}</td>
			<td style="text-align:right;">{{projs.dollars.0.get_currency_display|safe}} {{projs.status_not_cancelled.dollars.total_funds_needed|round|intcomma}}</td>
		</tr>
		{% endif %}
	</table>
	
</div>


{% endblock content %}
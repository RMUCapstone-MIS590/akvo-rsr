{% extends "rsr/base.html" %}

{% load i18n rsr_tags rsr_filters webdesign thumbnail counter_tags cache humanize sorting_tags pagination_tags %}

{% block breadcrum  %}{% endblock breadcrum  %}

{% block maincontent %}


<div class='container'>

  <div class='column span-14'>
    
    <h1 class="h0">{{focus_area}} projects</h1>
    <div class='column span-11'>
      <img width="240" height="180" style="float: left; margin: 0 20px 20px 0;" src="{% thumbnail focus_area.image 240x180 sharpen %}" alt="{{focus_area}}"/>
      <p>
        {{focus_area.description|linebreaks}}
      </p>
    </div>    
    <div class='column span-3 last'>
      <div class="blue_box">
        <div class="space20">
          <h2>Related focus area</h2>
          <a href="#" class="small">Learn more about<br/>{{focus_area}} &#x25B6;</a>
        </div>
      </div>
    </div>
    
    <div class='column span-14 last'>
      <h1>Our projects <span class="lt_grey">({{projects.count}} results)</span></h1>
      {% autosort projects %}
      {% autopaginate projects 4 %}
      <div class="white_box">
        {% paginate %}
        <table id="projects">
          <colgroup class="name_col"></colgroup>
          <colgroup span="6" class="colgroup"></colgroup>
          <tr>
            <th style="padding: 10px;">
              {% anchor name Name %}
            </th>
            <!--<th class="activeTableHeaderDesc">
              <a href="#" class="small">
                <div class="activeTableHeaderDesc">Country</div>
              </a>
            </th>-->
            <th>{% anchor country Country %}</th>
            <th>
               {% anchor country__continent Continent %}
            </th>
            <th>
              {% anchor status Status %}
            </th>
            <th>
              {% anchor latest_update 'Latest update' %}
            </th>
            <th>
                <p class="small">Partners</p>
            </th>
            <th style="border-right: 0;">
                <p class="small">Focus area</p>
            </th>
          </tr>
          {% for project in projects %}
            <tr>
              <td>
                <div class="space10">
                  <a href="{% url project_main project.id %}">
                    {% project_thumb project 100 75 'float:left; margin: 0 10px 10px 0;' %}
                    <p class="nano-lede strong link_blue">
                        {{project.name}}
                    </p> 
                  </a>
                  <p class="nano-lede">
                    Feugiat nulla facilisis at vero eros et accumsan et iusto odio dignissim qui blandit praesent.
                  </p> 
                </div>
              </td>
              <td>
                <p class="td-text">{{project.country}}</p>
              </td>
              <td>
                <p class="td-text">{{project.country.get_continent_display}}</p>
              </td>
              <td>
                <p class="td-text green">{{project.show_status}}</p>
              </td>
              <td>
                <p class="td-text">
                    {% if project.latest_update %}
                      <a href="{% url project_updates project.id %}#{{project.update_id}}">{{project.latest_update|string_to_date|date:"d M Y"}}</a>
                    {% else %}
                      {% trans 'Not yet' %}
                    {% endif %}
                </p>
              </td>
              <td>
                <p class="td-text">
                  {% for partner in project.project_partners.all %}
                    <a href="{% url org_detail partner.partner.id %}">{{partner.partner}}</a>{% if not forloop.last %}<br />{% endif %}
                  {% endfor %}
                </p>
              </td>
              <td>
                <p class="td-text">
                    {% for area in project.focus_areas %}
                        <a href="{% url focus_area area.slug %}">{{area.name}}</a><br/>
                    {% endfor %}
                </p>
              </td>
            </tr>
          {% endfor %}
        </table>
        {% paginate %}
      </div>
    </div>
  </div>

</div> 

{% endblock maincontent %}

{% block js %}

{{ block.super }}

{% if debug %}
  <script type="text/javascript" src="{{MEDIA_URL}}js/jquery-ui.min.js"></script>
{% else %}
  <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
{% endif %}

{% endblock js %}

{% block jq_ready %}

  jQ('#project_tabs').tabs();
  {{block.super}}

{% endblock jq_ready %}